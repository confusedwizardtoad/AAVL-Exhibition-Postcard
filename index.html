<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ocean Giants Certificate</title>
    <style>
        body { margin: 0; background: #001219; color: #fff; font-family: sans-serif; text-align: center; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; }
        
        #postcard { 
            width: 800px; height: 500px; 
            /* IMPORTANT: Use the exact filename including .png or .PNG */
            background: url("AAVLCompletionPostcard.png") center/cover no-repeat; 
            display: flex; flex-direction: column; justify-content: center; align-items: center; 
            border: 4px solid #33C7BE; border-radius: 10px;
        }

        /* Centering the QR and Input */
        .controls { 
            margin-top: 30px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            gap: 15px; 
        }
        
        #qrcode { background: white; padding: 10px; border-radius: 5px; }
        
        input { 
            padding: 12px; font-size: 1.2rem; border-radius: 5px; border: none; width: 300px; text-align: center;
        }

        .hidden { display: none !important; }
        button { background: #F26B38; color: white; border: none; padding: 15px 30px; border-radius: 5px; font-size: 1.1rem; cursor: pointer; margin-top: 10px; }
    </style>
</head>
<body>

<div id="postcard">
    <h1>Ocean Giant Ambassador</h1>
    <h2 id="display-name" style="font-size: 2.5rem; margin: 10px 0;">Visitor</h2>
    <p>Successfully completed the Ocean Giants Challenge!</p>
</div>

<!-- This area is now centered -->
<div class="controls" id="ui-controls">
    <label for="username">Type your name below:</label>
    <input type="text" id="username" placeholder="Enter Name here..." oninput="updateAll()">
    <div id="qrcode"></div>
    <p style="font-size: 0.9rem; opacity: 0.8;">Scan this QR code to download to your phone</p>
</div>

<button id="btn-download" onclick="downloadCert()" style="display:none;">Download Certificate</button>

<!-- Libraries -->
<script src="https://cdnjs.cloudflare.com"></script>
<script src="https://cdnjs.cloudflare.com"></script>

<script>
    const nameDisplay = document.getElementById("display-name");
    const qrcode = new QRCode(document.getElementById("qrcode"), { width: 150, height: 150 });

    window.onload = () => {
        const params = new URLSearchParams(window.location.search);
        if (params.has('name')) {
            nameDisplay.textContent = decodeURIComponent(params.get('name'));
            document.getElementById("ui-controls").classList.add("hidden");
            document.getElementById("btn-download").style.display = "block";
        } else {
            updateAll();
        }
    };

    function updateAll() {
        const val = document.getElementById("username").value || "Visitor";
        nameDisplay.textContent = val;
        // This creates the link for the phone to open
        const url = window.location.href.split('?')[0];
        qrcode.makeCode(`${url}?name=${encodeURIComponent(val)}`);
    }

    function downloadCert() {
        html2canvas(document.getElementById("postcard"), { useCORS: true }).then(canvas => {
            const link = document.createElement("a");
            link.download = "Ocean-Giant-Ambassador.png";
            link.href = canvas.toDataURL("image/png");
            link.click();
        });
    }
</script>
</body>
</html>
